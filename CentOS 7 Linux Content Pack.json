{"name":"CentOS 7 Linux operations","description":"This content pack checks some Linux operations and security activities like logon, logoff.\nIt has some usefull dashboards to overview the linux operations.\n\nMonitoring.World","category":"Linux","inputs":[{"id":"5ac3de2ae65c8c03763453d2","title":"Syslog:UDP:10514","configuration":{"expand_structured_data":false,"recv_buffer_size":262144,"port":10514,"override_source":null,"force_rdns":false,"allow_override_date":true,"bind_address":"0.0.0.0","store_full_message":false},"static_fields":{},"type":"org.graylog2.inputs.syslog.udp.SyslogUDPInput","global":true,"extractors":[{"title":"User Created","type":"REGEX","cursor_strategy":"COPY","target_field":"user_created","source_field":"message","configuration":{"regex_value":"\\]: new user: name=(.+?),\\s.*"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"User Deleted","type":"REGEX","cursor_strategy":"COPY","target_field":"user_deleted","source_field":"message","configuration":{"regex_value":"\\]: delete user \\'(.+?)\\'"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Group removed","type":"REGEX","cursor_strategy":"COPY","target_field":"group_removed","source_field":"message","configuration":{"regex_value":"\\]: removed group \\'(.+?)\\'"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Group created","type":"REGEX","cursor_strategy":"COPY","target_field":"group_created","source_field":"message","configuration":{"regex_value":"\\]: new group: name=(.+?),\\s.*"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"User password change","type":"REGEX","cursor_strategy":"COPY","target_field":"user_pswd_change","source_field":"message","configuration":{"regex_value":"chauthtok\\): password changed for (.+)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"User logged off","type":"REGEX","cursor_strategy":"COPY","target_field":"user_logged_off","source_field":"message","configuration":{"regex_value":"sshd:session\\): session closed for user (.+)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"User logged in","type":"REGEX","cursor_strategy":"COPY","target_field":"login_user","source_field":"message","configuration":{"regex_value":": Accepted password for (.+?)\\s.*"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"SSH Login IP","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{IPV4}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Password failed user","type":"REGEX","cursor_strategy":"COPY","target_field":"passwd_failed_user","source_field":"message","configuration":{"regex_value":": Failed password for (.+?)\\s.*"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"'su' session user","type":"REGEX","cursor_strategy":"COPY","target_field":"su_session_user","source_field":"message","configuration":{"regex_value":"\\(su-l:session\\): session opened for user (.+?)\\s.*"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"'su' opened by","type":"REGEX","cursor_strategy":"COPY","target_field":"su_opened_by_user","source_field":"message","configuration":{"regex_value":"\\(su-l:session\\): session opened for user .+?\\sby\\s(.+)\\("},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"'su' failed user","type":"REGEX","cursor_strategy":"COPY","target_field":"su_failed_user","source_field":"message","configuration":{"regex_value":"su: FAILED SU \\(to\\s(.+?)\\)\\s.*"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Yum package installed","type":"REGEX","cursor_strategy":"COPY","target_field":"yum_package_installed","source_field":"message","configuration":{"regex_value":"yum\\[.+]:\\s+Installed:\\s(.+)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Yum package removed","type":"REGEX","cursor_strategy":"COPY","target_field":"yum_package_removed","source_field":"message","configuration":{"regex_value":"yum\\[.+]:\\s+Erased:\\s(.+)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Service started","type":"REGEX","cursor_strategy":"COPY","target_field":"service_started","source_field":"message","configuration":{"regex_value":"systemd\\: Started (.+)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0},{"title":"Service stopped","type":"REGEX","cursor_strategy":"COPY","target_field":"service_stopped","source_field":"message","configuration":{"regex_value":"systemd\\: Stopped (.+)"},"converters":[],"condition_type":"NONE","condition_value":"","order":0}]}],"streams":[{"id":"5acf6fe15cee3803d5ecd56c","title":"CentOS7 : Security : 'su' opened by a privileged user","description":"'su' command entered successfully.","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"(su-l:session): session opened for user","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf70a45cee3803d5ecd649","title":"CentOS7 : Operations : A yum package installed","description":"A yum package installed","disabled":false,"matching_type":"AND","stream_rules":[{"type":"REGEX","field":"message","value":"yum\\[.+]:\\s+Installed","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf68c15cee3803d5eccd8b","title":"CentOS7 : Operations : Server booted","description":"Server booted","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"Command line: BOOT_IMAGE=","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6f305cee3803d5ecd4a4","title":"CentOS7 : Security : User logged off","description":"User logged off","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"sshd:session): session closed for user","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6d9c5cee3803d5ecd2dc","title":"CentOS7 : Operations : Group deleted","description":"A group deleted","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"]: removed group","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf5cfc5cee38037d1bb825","title":"CentOS7 : Security : SElinux disabled","description":"SElinux disabled","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"enforcing=1","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf5bca5cee38037d1bb6d2","title":"CentOS7: Security : SElinux activated","description":"SElinux is activated","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"enforcing=0","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf70f25cee3803d5ecd6a1","title":"CentOS7 : Operations : A yum package removed","description":"A yum package removed","disabled":false,"matching_type":"AND","stream_rules":[{"type":"REGEX","field":"message","value":"yum\\[.+]:\\s+Erased:\\s(.+)","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf63525cee3803d5b17792","title":"CentOS7 : Operations : Service started","description":"Service started","disabled":false,"matching_type":"AND","stream_rules":[{"type":"REGEX","field":"message","value":"systemd: Started\\s\\w+","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6aad5cee3803d5eccfa3","title":"CentOS7 : Operations : User created","description":"New user created","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"new user: name=","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6f8e5cee3803d5ecd50e","title":"CentOS7 : Security : Password failed","description":"Password failed","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":": Failed password for","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf5efb5cee38037d1bba52","title":"CentOS7 : Operations : Service stopped","description":"Service stopped","disabled":false,"matching_type":"AND","stream_rules":[{"type":"REGEX","field":"message","value":"systemd: Stopped\\s\\w+","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6efd5cee3803d5ecd46b","title":"CentOS7 : Security : User logged in","description":"User logged in","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":": Accepted password for","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6b2f5cee3803d5ecd035","title":"CentOS7 : Operations : User deleted","description":"User account deleted","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"]: delete user","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6e795cee3803d5ecd3d4","title":"CentOS7 : Operations : User password changed","description":"User changed password","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":": password changed for","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf6dfe5cee3803d5ecd349","title":"CentOS7 : Operations : Group created","description":"A group created","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"]: new group: name=","inverted":false,"description":""}],"outputs":[],"default_stream":false},{"id":"5acf705b5cee3803d5ecd5f6","title":"CentOS7 : Security : 'su' failed","description":"'su' failed","disabled":false,"matching_type":"AND","stream_rules":[{"type":"CONTAINS","field":"message","value":"su: FAILED SU","inverted":false,"description":""}],"outputs":[],"default_stream":false}],"outputs":[],"dashboards":[{"title":"CentOS7 : Operations : Package Management","description":"CentOS7 : Operations : Package Management","dashboard_widgets":[{"description":"Yum pkgs installed.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"yum_package_installed","query":"message:\".yum\" AND message:\".Installed\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":1,"row":2,"height":3,"width":1},{"description":"Yum pkgs installed by servers.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"source","query":"message:\".yum\" AND message:\".Installed\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":2,"row":2,"height":3,"width":1},{"description":"Yum packages installed last day.","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"count","renderer":"line","interpolation":"linear","timerange":{"type":"relative","range":86400},"rangeType":"relative","field":"yum_package_installed","query":"message:\".yum\" AND message:\".Installed\"","interval":"hour","relative":86400},"col":1,"row":1,"height":1,"width":2},{"description":"Yum pkgs removed.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"yum_package_removed","query":"message:\".yum\" AND message:\".Erased\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":4,"row":2,"height":3,"width":1},{"description":"Yum pkgs removed by server.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"source","query":"message:\".yum\" AND message:\".Erased\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":3,"row":2,"height":3,"width":1},{"description":"Yum packages removed last day.","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"count","renderer":"line","interpolation":"linear","timerange":{"type":"relative","range":86400},"rangeType":"relative","field":"yum_package_removed","query":"message:\".yum\" AND message:\".Erased\"","interval":"hour","relative":86400},"col":3,"row":1,"height":1,"width":2}]},{"title":"CentOS7 : Operations : Service management","description":"CentOS7 : Operations : Service management","dashboard_widgets":[{"description":"Services started last day.","type":"SEARCH_RESULT_CHART","cache_time":10,"configuration":{"interval":"hour","timerange":{"type":"relative","range":86400},"query":"message:\".systemd: Started\""},"col":1,"row":1,"height":1,"width":2},{"description":"Services started by servers.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"source","query":"message:\".systemd: Started\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":2,"row":2,"height":3,"width":1},{"description":"Services started.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"service_started","query":"message:\".systemd: Started\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":1,"row":2,"height":3,"width":1},{"description":"Services stopped","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"service_stopped","query":"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":3,"row":2,"height":3,"width":1},{"description":"Services stopped last day.","type":"SEARCH_RESULT_CHART","cache_time":10,"configuration":{"interval":"hour","timerange":{"type":"relative","range":86400},"query":"message:\".systemd: Stopped\""},"col":3,"row":1,"height":1,"width":2},{"description":"Services stopped by servers.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"source","query":"message:\".systemd: Stopped\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":4,"row":4,"height":3,"width":1}]},{"title":"CentOS7 : Security : Account management","description":"CentOS7 : Security : Account management","dashboard_widgets":[{"description":"Groups created.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"group_created","query":"message:\".new group: name=\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":2,"row":2,"height":3,"width":1},{"description":"Groups created last day.","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"count","renderer":"line","interpolation":"cardinal","timerange":{"type":"relative","range":86400},"rangeType":"relative","field":"group_created","query":"message:\".new group: name=\"","interval":"hour","relative":86400},"col":1,"row":1,"height":1,"width":2},{"description":"Groups created by servers.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"source","query":"message:\".new group: name=\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":1,"row":2,"height":3,"width":1},{"description":"Groups removed by servers.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"source","query":"message:\".removed group\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":4,"row":2,"height":3,"width":1},{"description":"Groups removed.","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":86400},"field":"group_removed","query":"message:\".removed group\"","show_data_table":true,"limit":5,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":3,"row":2,"height":3,"width":1},{"description":"Groups removed last day.","type":"FIELD_CHART","cache_time":10,"configuration":{"valuetype":"count","renderer":"line","interpolation":"linear","timerange":{"type":"relative","range":86400},"rangeType":"relative","field":"group_removed","query":"message:\".removed group\"","interval":"hour","relative":86400},"col":3,"row":1,"height":1,"width":2}]}],"grok_patterns":[],"lookup_tables":[],"lookup_caches":[],"lookup_data_adapters":[]}